{"ast":null,"code":"import _slicedToArray from\"/Users/carldiederichs/code/carldiederichs/javascript-projects/mern-udemy/places-mern-project/react-frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useState,useCallback,useEffect}from'react';var logoutTimer;export var useAuth=function useAuth(){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),token=_useState2[0],setToken=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),tokenExpirationDate=_useState4[0],setTokenExpirationDate=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),userId=_useState6[0],setUserId=_useState6[1];var login=useCallback(function(uid,token,expirationDate){setToken(token);setUserId(uid);var tokenExpirationDate=expirationDate||new Date(new Date().getTime()+1000*60*60);setTokenExpirationDate(tokenExpirationDate);localStorage.setItem('userData',JSON.stringify({userId:uid,token:token,expiration:tokenExpirationDate.toISOString()}));},[]);var logout=useCallback(function(){setToken(null);setTokenExpirationDate(null);setUserId(null);localStorage.removeItem('userData');},[]);useEffect(function(){if(token&&tokenExpirationDate){var remainingTime=tokenExpirationDate.getTime()-new Date().getTime();logoutTimer=setTimeout(logout,remainingTime);}else{clearTimeout(logoutTimer);}},[token,logout,tokenExpirationDate]);useEffect(function(){var storedData=JSON.parse(localStorage.getItem('userData'));if(storedData&&storedData.token&&new Date(storedData.expiration)>new Date()){login(storedData.userId,storedData.token,new Date(storedData.expiration));}},[login]);return{token:token,login:login,logout:logout,userId:userId};};","map":{"version":3,"names":["useState","useCallback","useEffect","logoutTimer","useAuth","_useState","_useState2","_slicedToArray","token","setToken","_useState3","_useState4","tokenExpirationDate","setTokenExpirationDate","_useState5","_useState6","userId","setUserId","login","uid","expirationDate","Date","getTime","localStorage","setItem","JSON","stringify","expiration","toISOString","logout","removeItem","remainingTime","setTimeout","clearTimeout","storedData","parse","getItem"],"sources":["/Users/carldiederichs/code/carldiederichs/javascript-projects/mern-udemy/places-mern-project/react-frontend/src/shared/hooks/auth-hook.js"],"sourcesContent":["import { useState, useCallback, useEffect } from 'react';\n\nlet logoutTimer; \n\nexport const useAuth = () => {\n  const [token, setToken] = useState(false); \n  const [tokenExpirationDate, setTokenExpirationDate] = useState(false); \n  const [userId, setUserId] = useState(false); \n\n  const login = useCallback((uid, token, expirationDate) => {\n    setToken(token); \n    setUserId(uid); \n    const tokenExpirationDate = \n      expirationDate || new Date(new Date().getTime() + 1000 * 60 * 60); \n    setTokenExpirationDate(tokenExpirationDate); \n    localStorage.setItem(\n      'userData', \n      JSON.stringify({\n        userId: uid, \n        token: token, \n        expiration: tokenExpirationDate.toISOString()\n      })\n    );\n  }, []);\n\n  const logout = useCallback(() => {\n    setToken(null); \n    setTokenExpirationDate(null);\n    setUserId(null);\n    localStorage.removeItem('userData');\n  }, []);\n\n  useEffect(() => {\n    if (token && tokenExpirationDate) {\n      const remainingTime = tokenExpirationDate.getTime() - new Date().getTime(); \n      logoutTimer = setTimeout(logout, remainingTime); \n    } else {\n      clearTimeout(logoutTimer);\n    }\n  }, [token, logout, tokenExpirationDate]); \n\n  useEffect(() => {\n    const storedData = JSON.parse(localStorage.getItem('userData'));\n    if (\n      storedData && \n      storedData.token && \n      new Date(storedData.expiration) > new Date()\n    ) {\n      login(storedData.userId, storedData.token, new Date(storedData.expiration));\n    }\n  }, [login]);\n\n  return { token, login, logout, userId }; \n}"],"mappings":"8LAAA,OAASA,QAAQ,CAAEC,WAAW,CAAEC,SAAS,KAAQ,OAAO,CAExD,GAAI,CAAAC,WAAW,CAEf,MAAO,IAAM,CAAAC,OAAO,CAAG,QAAV,CAAAA,OAAOA,CAAA,CAAS,CAC3B,IAAAC,SAAA,CAA0BL,QAAQ,CAAC,KAAK,CAAC,CAAAM,UAAA,CAAAC,cAAA,CAAAF,SAAA,IAAlCG,KAAK,CAAAF,UAAA,IAAEG,QAAQ,CAAAH,UAAA,IACtB,IAAAI,UAAA,CAAsDV,QAAQ,CAAC,KAAK,CAAC,CAAAW,UAAA,CAAAJ,cAAA,CAAAG,UAAA,IAA9DE,mBAAmB,CAAAD,UAAA,IAAEE,sBAAsB,CAAAF,UAAA,IAClD,IAAAG,UAAA,CAA4Bd,QAAQ,CAAC,KAAK,CAAC,CAAAe,UAAA,CAAAR,cAAA,CAAAO,UAAA,IAApCE,MAAM,CAAAD,UAAA,IAAEE,SAAS,CAAAF,UAAA,IAExB,GAAM,CAAAG,KAAK,CAAGjB,WAAW,CAAC,SAACkB,GAAG,CAAEX,KAAK,CAAEY,cAAc,CAAK,CACxDX,QAAQ,CAACD,KAAK,CAAC,CACfS,SAAS,CAACE,GAAG,CAAC,CACd,GAAM,CAAAP,mBAAmB,CACvBQ,cAAc,EAAI,GAAI,CAAAC,IAAI,CAAC,GAAI,CAAAA,IAAI,EAAE,CAACC,OAAO,EAAE,CAAG,IAAI,CAAG,EAAE,CAAG,EAAE,CAAC,CACnET,sBAAsB,CAACD,mBAAmB,CAAC,CAC3CW,YAAY,CAACC,OAAO,CAClB,UAAU,CACVC,IAAI,CAACC,SAAS,CAAC,CACbV,MAAM,CAAEG,GAAG,CACXX,KAAK,CAAEA,KAAK,CACZmB,UAAU,CAAEf,mBAAmB,CAACgB,WAAW,EAC7C,CAAC,CAAC,CACH,CACH,CAAC,CAAE,EAAE,CAAC,CAEN,GAAM,CAAAC,MAAM,CAAG5B,WAAW,CAAC,UAAM,CAC/BQ,QAAQ,CAAC,IAAI,CAAC,CACdI,sBAAsB,CAAC,IAAI,CAAC,CAC5BI,SAAS,CAAC,IAAI,CAAC,CACfM,YAAY,CAACO,UAAU,CAAC,UAAU,CAAC,CACrC,CAAC,CAAE,EAAE,CAAC,CAEN5B,SAAS,CAAC,UAAM,CACd,GAAIM,KAAK,EAAII,mBAAmB,CAAE,CAChC,GAAM,CAAAmB,aAAa,CAAGnB,mBAAmB,CAACU,OAAO,EAAE,CAAG,GAAI,CAAAD,IAAI,EAAE,CAACC,OAAO,EAAE,CAC1EnB,WAAW,CAAG6B,UAAU,CAACH,MAAM,CAAEE,aAAa,CAAC,CACjD,CAAC,IAAM,CACLE,YAAY,CAAC9B,WAAW,CAAC,CAC3B,CACF,CAAC,CAAE,CAACK,KAAK,CAAEqB,MAAM,CAAEjB,mBAAmB,CAAC,CAAC,CAExCV,SAAS,CAAC,UAAM,CACd,GAAM,CAAAgC,UAAU,CAAGT,IAAI,CAACU,KAAK,CAACZ,YAAY,CAACa,OAAO,CAAC,UAAU,CAAC,CAAC,CAC/D,GACEF,UAAU,EACVA,UAAU,CAAC1B,KAAK,EAChB,GAAI,CAAAa,IAAI,CAACa,UAAU,CAACP,UAAU,CAAC,CAAG,GAAI,CAAAN,IAAI,EAAE,CAC5C,CACAH,KAAK,CAACgB,UAAU,CAAClB,MAAM,CAAEkB,UAAU,CAAC1B,KAAK,CAAE,GAAI,CAAAa,IAAI,CAACa,UAAU,CAACP,UAAU,CAAC,CAAC,CAC7E,CACF,CAAC,CAAE,CAACT,KAAK,CAAC,CAAC,CAEX,MAAO,CAAEV,KAAK,CAALA,KAAK,CAAEU,KAAK,CAALA,KAAK,CAAEW,MAAM,CAANA,MAAM,CAAEb,MAAM,CAANA,MAAO,CAAC,CACzC,CAAC"},"metadata":{},"sourceType":"module"}